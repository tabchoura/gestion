<div class="wrap">
  <h2>üë§ Mon Profil</h2>
  <div class="card">
    <!-- HEADER -->
    <div class="thead">
      <div>D√©tails</div>
      <div class="thead-actions">
        <button class="btn-add" type="button" (click)="toggleEdit()">
          {{ editMode() ? 'Annuler' : 'Modifier' }}
        </button>
      </div>
    </div>

    <!-- FORMULAIRE PROFIL -->
    <form class="inline-form profile-form" [formGroup]="form" (ngSubmit)="save()">
      <div class="rowitem">
        <div><b>Email</b></div>
        <div>
          <input formControlName="email"
                 [readonly]="!editMode()"
                 [class.invalid]="editMode() && email?.touched && email?.invalid" />
          <small class="error" *ngIf="editMode() && email?.touched && email?.hasError('required')">
            Email requis.
          </small>
          <small class="error" *ngIf="editMode() && email?.touched && email?.hasError('email')">
            Format invalide.
          </small>
        </div>
      </div>

      <div class="rowitem">
        <div><b>Nom</b></div>
        <div>
          <input formControlName="nom"
                 [readonly]="!editMode()"
                 [class.invalid]="editMode() && nom?.touched && nom?.invalid" />
          <small class="error" *ngIf="editMode() && nom?.touched && nom?.invalid">
            Nom requis.
          </small>
        </div>
      </div>

      <div class="rowitem">
        <div><b>Pr√©nom</b></div>
        <div>
          <input formControlName="prenom"
                 [readonly]="!editMode()"
                 [class.invalid]="editMode() && prenom?.touched && prenom?.invalid" />
          <small class="error" *ngIf="editMode() && prenom?.touched && prenom?.invalid">
            Pr√©nom requis.
          </small>
        </div>
      </div>

      <div class="rowitem">
        <div><b>Num√©ro CIN</b></div>
        <div>
          <input formControlName="numCin" maxlength="8"
                 [readonly]="!editMode()"
                 [class.invalid]="editMode() && numCin?.touched && numCin?.invalid" />
          <small class="error" *ngIf="editMode() && numCin?.touched && numCin?.hasError('required')">
            CIN requis.
          </small>
          <small class="error" *ngIf="editMode() && numCin?.touched && numCin?.hasError('pattern')">
            Doit contenir 8 chiffres.
          </small>
        </div>
      </div>

      <!-- <div class="rowitem">
        <div><b>Num√©ro de compte bancaire</b></div>
        <div>
          <input formControlName="numCompteBancaire" maxlength="20"
                 [readonly]="!editMode()"
                 [class.invalid]="editMode() && numCompteBancaire?.touched && numCompteBancaire?.invalid" />
          <small class="error" *ngIf="editMode() && numCompteBancaire?.touched && numCompteBancaire?.hasError('required')">
            Requis.
          </small>
          <small class="error" *ngIf="editMode() && numCompteBancaire?.touched && numCompteBancaire?.hasError('pattern')">
            Entre 10 et 20 chiffres.
          </small>
        </div>
      </div> -->

      <!-- ACTIONS -->
      <div class="inline-actions" *ngIf="editMode()">
        <button type="submit" [disabled]="loading() || form.invalid" class="btn success">
          {{ loading() ? 'Enregistrement‚Ä¶' : 'Enregistrer' }}
        </button>
        <button type="button" class="ghost" (click)="toggleEdit()" [disabled]="loading()">
          Annuler
        </button>
      </div>
    </form>

    <!-- MESSAGES -->
    <div *ngIf="msg()" class="server-success">{{ msg() }}</div>
    <div *ngIf="err()" class="server-error">{{ err() }}</div>
    <div *ngIf="err() && err().includes('Session non valide')">
      <button class="btn success" type="button" (click)="reconnect()">
        Se reconnecter
      </button>
    </div>
  </div>
</div>
