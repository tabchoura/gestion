<div class="wrap historique-container">
  <h2>📜 Mon Historique</h2>

  <div *ngIf="errorMsg()" class="error">
    {{ errorMsg() }}
  </div>

  <div class="actions-header">
    <!-- <button class="btn light" (click)="load()" [disabled]="loading()">
      {{ loading() ? '⏳ Chargement...' : '🔄 Actualiser' }}
    </button> -->
  </div>

  <div *ngIf="loading()" class="loading">
    ⏳ Chargement en cours...
  </div>

  <div *ngIf="!loading()" class="card history-list">
    <div *ngIf="historique().length === 0" class="empty">
      Aucun historique trouvé.
    </div>

    <div *ngFor="let item of historique()" class="history-item">
      <div class="header">
        <div class="left">
          <span class="badge">{{ actionLabel(item.action) }}</span>
          <strong class="summary">{{ summary(item) }}</strong>
        </div>
        <span class="date" title="{{ item.creeLe | date:'full' }}">
          {{ item.creeLe | date:'short' }}
        </span>
      </div>

      <div class="content">
        <p *ngIf="item.message" class="message">{{ item.message }}</p>

        <div class="meta">
          <span class="email" title="Utilisateur">
            👤 {{ item.acteurEmail }}
          </span>

          <span *ngIf="item.page" class="page" title="Page">
            • 📄 {{ item.page }}
          </span>

          <span *ngIf="item.ressourceType || item.ressourceLabel || item.ressourceId" class="resource">
            • 🗂️ {{ item.ressourceType || 'Ressource' }}
            <ng-container *ngIf="item.ressourceLabel">: {{ item.ressourceLabel }}</ng-container>
            <ng-container *ngIf="item.ressourceId"> (#{{ item.ressourceId }})</ng-container>
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
