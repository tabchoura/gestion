<div class="historique-container">
  <h2>Mon Historique</h2>

  <!-- Message d'erreur -->
  <div *ngIf="errorMsg()" class="error">
    {{ errorMsg() }}
  </div>

  <!-- Boutons d'action -->
  <div class="actions">
    <button (click)="load()" [disabled]="loading()">
      {{ loading() ? 'Chargement...' : 'Actualiser' }}
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading()" class="loading">
    Chargement...
  </div>

  <!-- Liste -->
  <div *ngIf="!loading()" class="history-list">
    <div *ngIf="historique().length === 0" class="empty">
      Aucun historique trouvé.
    </div>

    <div *ngFor="let item of historique()" class="history-item">
      <div class="header">
        <div class="left">
          <span class="badge">{{ actionLabel(item.action) }}</span>
          <strong class="summary">{{ summary(item) }}</strong>
        </div>
        <span class="date" title="{{ item.creeLe | date:'full' }}">
          {{ item.creeLe | date:'short' }}
        </span>
      </div>

      <div class="content">
        <p *ngIf="item.message" class="message">{{ item.message }}</p>

        <div class="meta">
          <span class="email" title="Utilisateur">
            {{ item.acteurEmail }}
          </span>

          <span *ngIf="item.page" class="page" title="Page">
            • {{ item.page }}
          </span>

          <span *ngIf="item.ressourceType || item.ressourceLabel || item.ressourceId" class="resource">
            • {{ item.ressourceType || 'Ressource' }}
            <ng-container *ngIf="item.ressourceLabel">: {{ item.ressourceLabel }}</ng-container>
            <ng-container *ngIf="item.ressourceId"> (#{{ item.ressourceId }})</ng-container>
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
